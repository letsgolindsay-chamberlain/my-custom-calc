<!-- 
    This is a single, self-contained HTML file.
    All CSS (custom styles) and JavaScript (calculator logic and Tailwind config) 
    are included directly in <style> and <script> tags to ensure it runs immediately 
    and reliably in embedding tools.
-->

<!-- 1. Load Custom Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Great+Vibes&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
<!-- 2. Load Tailwind CDN -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- 3. CSS Section: Custom Styles (from style.css) -->
<style>
  /* ----------------------------------------------------------------------- */
  /* GLOBAL STYLES & TAILWIND CUSTOM RADIO BUTTONS                          */
  /* ----------------------------------------------------------------------- */
  /* Use the new font family for the entire app */
  .embed-container {
    font-family: 'Open Sans', sans-serif;
    color: #202d4f;
    /* Use primary-dark text color */
  }

  /* Custom font utilities (defined in Tailwind config via JS) */
  .font-impact {
    font-family: 'Bebas Neue', sans-serif;
  }

  .font-cursive {
    font-family: 'Great Vibes', cursive;
  }

  /* Base style for custom radio inputs (hidden but styled siblings) */
  .custom-radio {
    /* Hide the default radio button */
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
  }

  /* Style for the <label> associated with the radio input */
  .track-label {
    transition: all 0.2s ease;
    border-color: #e5e7eb;
    /* default gray border */
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  }

  /* Style for the label when the corresponding radio input is CHECKED */
  .custom-radio:checked+.track-label {
    /* New highlight color: #f9a828 */
    border-color: #f9a828;
    /* Slightly more prominent shadow for selection */
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
    background-color: #f9a8281a;
    /* Very light highlight background */
  }

  /* Style for the label when the mouse hovers over it */
  .track-label:hover {
    border-color: #f9a828;
  }
</style>

<!-- 4. Main HTML Structure -->
<div id="app" class="font-body embed-container w-full bg-white p-6 md:p-10 rounded-2xl shadow-xl border-t-4 border-highlight">
  <header class="text-center mb-8">
    <h1 class="text-3xl font-impact tracking-widest font-normal text-primary-dark uppercase">Determine Your Project Investment</h1>
    <p class="mt-2 text-gray-700">Select the service track that matches your goal and estimate your scope.</p>
  </header>

  <!-- Service Selection -->
  <section class="mb-8">
    <h2 class="text-xl font-impact tracking-wide text-primary-dark mb-4 border-b pb-2">1. Choose Your Service Track</h2>
    <div id="service-options" class="grid grid-cols-1 md:grid-cols-3 gap-4">

      <!-- Track I Option: Estate & Physical Transitions -->
      <input type="radio" id="track1" name="service" value="track1" class="custom-radio" checked>
      <label for="track1" class="p-4 rounded-lg border-2 border-gray-300 text-center cursor-pointer transition duration-200 hover:border-highlight text-primary-dark font-medium track-label">
        <span class="block text-lg font-impact tracking-wider">TRACK I</span>
        <span class="block text-xs text-gray-500 mt-1">Estate & Physical Transitions</span>
        <span class="block text-xs font-semibold mt-1 text-action-secondary">Rate: $200/hr | Min: 15 hrs</span>
      </label>

      <!-- Track II Option: Business & Organizational Services -->
      <input type="radio" id="track2" name="service" value="track2" class="custom-radio">
      <label for="track2" class="p-4 rounded-lg border-2 border-gray-300 text-center cursor-pointer transition duration-200 hover:border-highlight text-primary-dark font-medium track-label">
        <span class="block text-lg font-impact tracking-wider">TRACK II</span>
        <span class="block text-xs text-gray-500 mt-1">Business & Organizational Systems</span>
        <span class="block text-xs font-semibold mt-1 text-action-secondary">Rate: $200/hr | Min: 15 hrs</span>
      </label>

      <!-- Track III Option: Focused Sessions -->
      <!-- Updated Rate/Min for Track III -->
      <input type="radio" id="track3" name="service" value="track3" class="custom-radio">
      <label for="track3" class="p-4 rounded-lg border-2 border-gray-300 text-center cursor-pointer transition duration-200 hover:border-highlight text-primary-dark font-medium track-label">
        <span class="block text-lg font-impact tracking-wider">TRACK III</span>
        <span class="block text-xs text-gray-500 mt-1">Focused Sessions & De-influencing</span>
        <span class="block text-xs font-semibold mt-1 text-action-secondary">Rate: $200/hr | Min: 2 hrs</span>
      </label>
    </div>
  </section>

  <!-- Service Descriptions -->
  <!-- Updated to dynamically switch between track details -->
  <section id="service-details" class="mb-8 p-4 bg-card-bg rounded-lg border border-gray-200">
    <h3 id="track-title" class="text-base font-bold text-primary-dark mb-2">Track I Details:</h3>
    <p id="track-description" class="text-sm text-gray-700 transition duration-300 ease-in-out">
      <!-- Description injected here by JS -->
    </p>
    <ul id="track-bullets" class="text-sm text-gray-700 mt-2 list-disc list-inside space-y-1">
      <!-- Bullets injected here by JS -->
    </ul>
  </section>

  <!-- Scope Selection: Tiers (for Track I & II) OR Custom Input (for Track III) -->
  <section class="mb-8">
    <h2 class="text-xl font-impact tracking-wide text-primary-dark mb-4 border-b pb-2">2. Estimate Project Scope (Tier)</h2>
    
    <!-- Tiers (Visible for Track I & II) -->
    <div id="scope-tiers" class="grid grid-cols-3 gap-4 transition-opacity duration-300">
      
      <!-- Tier 1 Scope Option - $3,000 (15 hours) -->
      <input type="radio" id="scope-small" name="scope" value="small" class="custom-radio" checked>
      <label for="scope-small" class="p-4 rounded-lg border-2 border-gray-300 text-center cursor-pointer transition duration-200 hover:border-highlight text-primary-dark font-medium track-label">
        <span class="font-impact tracking-wider">TIER 1 (ENTRY)</span>
        <span class="block text-xs text-gray-500 mt-1">Min 15 Hours, Focused Area</span>
        <span class="block text-base font-semibold text-action-primary mt-1">Starting at $3,000</span>
      </label>

      <!-- Tier 2 Scope Option - $6,000 (30 hours) -->
      <input type="radio" id="scope-medium" name="scope" value="medium" class="custom-radio">
      <label for="scope-medium" class="p-4 rounded-lg border-2 border-gray-300 text-center cursor-pointer transition duration-200 hover:border-highlight text-primary-dark font-medium track-label">
        <span class="font-impact tracking-wider">TIER 2 (STANDARD)</span>
        <span class="block text-xs text-gray-500 mt-1">30 Estimated Hours, Multiple Areas</span>
        <span class="block text-base font-semibold text-action-primary mt-1">Starting at $6,000</span>
      </label>

      <!-- Tier 3 Scope Option - $11,000 (55 hours) -->
      <input type="radio" id="scope-large" name="scope" value="large" class="custom-radio">
      <label for="scope-large" class="p-4 rounded-lg border-2 border-gray-300 text-center cursor-pointer transition duration-200 hover:border-highlight text-primary-dark font-medium track-label">
        <span class="font-impact tracking-wider">TIER 3 (COMPREHENSIVE)</span>
        <span class="block text-xs text-gray-500 mt-1">55 Estimated Hours, Full Scale</span>
        <span class="block text-base font-semibold text-action-primary mt-1">Starting at $11,000</span>
      </label>
    </div>

    <!-- Custom Hours Input (Hidden by default, shown for Track III) -->
    <div id="custom-hours-input" class="hidden p-4 rounded-lg bg-gray-100 border border-gray-300 transition-opacity duration-300">
        <label for="custom-hours" class="block mb-2 text-sm font-medium text-gray-700">Enter Estimated Hours (Track III Minimum: 2 Hours)</label>
        <input type="number" id="custom-hours" min="2" value="2" step="1"
               class="w-full px-4 py-2 border border-gray-300 rounded-lg text-lg font-impact tracking-wide text-primary-dark focus:ring-highlight focus:border-highlight transition"
               placeholder="Minimum 2 Hours">
        <p class="text-xs text-gray-500 mt-2">Track III uses custom hour estimates, priced at $200/hr. The calculation will enforce a minimum of 2 hours ($400).</p>
    </div>
  </section>

  <!-- Premium Eco-Recycling Option -->
  <section class="mb-10 p-4 bg-highlight/10 rounded-lg border border-highlight/50">
    <h2 class="text-xl font-impact tracking-wide text-primary-dark mb-3 border-b border-highlight/50 pb-2 flex items-center">
      <!-- Icon for Eco-Recycling - Using the Secondary Accent color -->
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-action-secondary" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm-1-9a1 1 0 000 2h2a1 1 0 100-2h-2z" clip-rule="evenodd" />
        <path fill-rule="evenodd" d="M10 3a7 7 0 110 14 7 7 0 010-14zM4 10a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1z" clip-rule="evenodd" />
      </svg>
      3. Premium Eco-Recycling Surcharge
    </h2>

    <div class="flex items-center justify-between">
      <p class="text-sm text-gray-700 md:w-3/4">
        Opt-in for specialized, hard-to-recycle waste management (e.g., TerraCycle, specialty e-waste). This fee covers the transparent cost of proprietary collection and dedicated transport.
      </p>
      <label for="eco-recycling-toggle" class="relative inline-flex items-center cursor-pointer">
        <input type="checkbox" id="eco-recycling-toggle" value="" class="sr-only peer">
        <!-- Using a complementary color for the toggle switch -->
        <div class="w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-highlight/50 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-action-secondary"></div>
        <span class="ml-3 text-sm font-medium text-gray-900">Include Fee</span>
      </label>
    </div>
  </section>

  <!-- Complexity/Modifier Slider -->
  <section class="mb-10">
    <h2 class="text-xl font-impact tracking-wide text-primary-dark mb-4 border-b pb-2">4. Project Complexity Modifier</h2>
    <label for="complexity-slider" class="block mb-2 text-sm font-medium text-gray-700">How challenging is the current state of the space or systems?</label>
    <input type="range" id="complexity-slider" min="1" max="5" value="3" step="1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer range-lg">

    <div class="flex justify-between text-xs mt-2 text-gray-600">
      <span>Straightforward (1)</span>
      <span class="font-semibold text-primary-dark">Average Challenge (3)</span>
      <span>Highly Complex (5)</span>
    </div>
  </section>

  <!-- Result Display -->
  <div class="bg-card-bg p-6 rounded-xl shadow-inner border border-highlight/30 text-center">
    <p class="text-lg text-primary-dark font-impact tracking-wider">ESTIMATED PROJECT COST:</p>
    <p id="estimated-cost" class="text-5xl font-impact tracking-wider text-action-primary mt-2 transition duration-500 transform scale-105">
      $400
    </p>
    <p id="cost-breakdown" class="text-sm text-gray-700 mt-3 font-medium"></p>
    <p class="text-xs text-gray-500 mt-1">
      * This is a dynamic estimate. A final quote requires a detailed consultation.
    </p>

    <!-- Action Button (Book Session) -->
    <!-- UPDATED: Setting the href to the user-provided link for the connect page -->
    <a href="https://provenanceestatesolutions.com/#connect" target="_top" class="inline-block mt-4 w-full md:w-auto px-8 py-3 bg-action-primary text-white font-impact tracking-wider rounded-full shadow-lg hover:bg-highlight transition duration-300 uppercase no-underline">
      Book Your Complimentary Discovery Session
    </a>
  </div>
</div>

<!-- 5. JavaScript Section: Tailwind Config and Calculator Logic (from script.js) -->
<script>
  // Configure Tailwind utility classes for use in the HTML and CSS
  tailwind.config = {
    theme: {
      extend: {
        // Custom font families for site consistency
        fontFamily: {
          // Body font (Open Sauce -> Open Sans substitution)
          'body': ['"Open Sans"', 'sans-serif'],
          // Impact/Bold font (Bebas Neue)
          'impact': ['"Bebas Neue"', 'sans-serif'],
          // Cursive/Title font (Great Vibes)
          'cursive': ['"Great Vibes"', 'cursive'],
        },
        // Custom sunset-themed color palette
        colors: {
          // Dark background/Primary text color (Dark Blue)
          'primary-dark': '#202d4f',
          // Light background/Card background (Cream)
          'card-bg': '#f9f7f0',
          // Highlight/Accent color (Gold/Orange)
          'highlight': '#f9a828',
          // Action Button Primary (Deep Red/Maroon)
          'action-primary': '#bf4146',
          // Secondary Accent/Link/Info color (Soft Blue/Lavender)
          'action-secondary': '#a0a8d9',
          // Tertiary Accent/Complementary color (Soft Pink)
          'tertiary-accent': '#fdd2e8',
        },
      },
    },
  };

  // Application logic (Calculation script)
  document.addEventListener('DOMContentLoaded', () => {
    // Helper function for safe ID lookup
    const getEl = (id) => document.getElementById(id);

    // Elements
    const serviceOptions = getEl('service-options');
    const scopeTiers = getEl('scope-tiers'); // HTML element (ID: scope-tiers)
    const customHoursInputDiv = getEl('custom-hours-input');
    const customHoursInput = getEl('custom-hours');
    const ecoRecyclingToggle = getEl('eco-recycling-toggle');
    const complexitySlider = getEl('complexity-slider');
    const trackTitle = getEl('track-title');
    const trackDescription = getEl('track-description');
    const trackBullets = getEl('track-bullets');
    const estimatedCostDisplay = getEl('estimated-cost');
    const costBreakdownDisplay = getEl('cost-breakdown');

    // Configuration Data (Updated with new rates and descriptions)
    const HOURLY_RATE = 200;
    const serviceTracks = {
      track1: {
        rate: HOURLY_RATE,
        minHours: 15,
        title: 'Track I Details: Estate & Physical Transitions',
        description: "The $200/hr rate covers all on-site work, travel, vendor coordination, donation drop-offs, and administrative time. I'm committed to finding true second lives for items and minimizing environmental impact.",
        bullets: [
          'Full-service estate management',
          'Downsizing and decluttering support',
          'Donation coordination and strategic placement'
        ]
      },
      track2: {
        rate: HOURLY_RATE,
        minHours: 15,
        title: 'Track II Details: Business & Organizational Systems',
        description: "The $200/hr rate covers systems assessment, implementation, vendor coordination, staff training, and administrative setup.",
        bullets: [
          'Database migration and consolidation',
          'Project management system deployment',
          'Administrative efficiency and workflow documentation'
        ]
      },
      track3: {
        rate: HOURLY_RATE,
        minHours: 2, // New min hours for custom entry
        title: 'Track III Details: Focused Sessions & De-influencing',
        description: "The $200/hr rate covers on-site work, assessment, coordination, travel, and follow-up. Perfect for focused support without a full project commitment.",
        bullets: [
          'Single-room or focused area organizing',
          'Holiday decluttering (e.g., "Santa Needs Space")',
          'Side-by-side decluttering sessions',
          'Donation coordination'
        ]
      }
    };

    // Hours for Tracks I & II
    // RENAMED scopeTiers to scopeTiersData to resolve the SyntaxError
    const scopeTiersData = { 
      small: { hours: 15, label: 'TIER 1 (ENTRY)' },
      medium: { hours: 30, label: 'TIER 2 (STANDARD)' },
      large: { hours: 55, label: 'TIER 3 (COMPREHENSIVE)' }
    };

    const ecoRecyclingFee = 350;
    const complexityModifier = {
      1: 0.9, // -10% discount for very straightforward
      2: 0.95,
      3: 1.0, // Base rate
      4: 1.05,
      5: 1.15 // +15% surcharge for highly complex
    };

    // State
    let currentTrack = 'track1';
    let currentScope = 'small'; // Default scope for Tracks I/II
    let isEcoRecycling = false;
    let currentComplexity = 3;

    // Get the currently selected scope hours (or custom hours for track 3)
    const getProjectHours = () => {
      if (currentTrack === 'track3') {
        // Track III uses custom hours, minimum 2
        let hours = parseInt(customHoursInput.value, 10) || serviceTracks.track3.minHours;
        return Math.max(hours, serviceTracks.track3.minHours);
      } else {
        // Tracks I & II use tiers
        // Using scopeTiersData here
        return scopeTiersData[currentScope]?.hours || serviceTracks[currentTrack].minHours; 
      }
    };

    // Core Calculation Logic
    const calculateCost = () => {
      const track = serviceTracks[currentTrack];
      const hours = getProjectHours();
      const modifier = complexityModifier[currentComplexity];
      
      let baseCost = hours * track.rate;
      let breakdownText = '';

      // Set base breakdown text
      if (currentTrack === 'track3') {
        breakdownText = `(Hourly Rate: $${track.rate}/hr x ${hours} hrs | Min 2 hrs)`;
      } else {
        // Tracks I & II
        // Using scopeTiersData here
        const tier = scopeTiersData[currentScope]?.label || 'Tier 1';
        breakdownText = `(${tier} | $${track.rate}/hr x ${hours} hrs)`;
      }

      let totalCost = baseCost;

      // Apply complexity modifier
      if (modifier !== 1.0) {
        const modifierAmount = totalCost * (modifier - 1);
        totalCost += modifierAmount;
        breakdownText += ` | Modifier: ${Math.round(modifier * 100)}%`;
      }

      // Add eco-recycling fee if checked
      if (isEcoRecycling) {
        totalCost += ecoRecyclingFee;
        breakdownText += ` | Eco Fee: $${ecoRecyclingFee}`;
      }

      // Update UI
      estimatedCostDisplay.textContent = `$${Math.round(totalCost).toLocaleString()}`;
      costBreakdownDisplay.textContent = breakdownText;
    };

    // Update Service Description and manage visibility of scope selection
    const updateDescription = () => {
      const track = serviceTracks[currentTrack];
      
      trackTitle.textContent = track.title;
      trackDescription.textContent = track.description;
      
      // Update bullets
      trackBullets.innerHTML = track.bullets.map(b => `<li>${b}</li>`).join('');

      // Manage visibility of Tiers vs. Custom Hours Input
      if (currentTrack === 'track3') {
        scopeTiers.classList.add('hidden');
        customHoursInputDiv.classList.remove('hidden');
        // Ensure custom hours starts at minimum 2 when switching to Track III
        customHoursInput.value = serviceTracks.track3.minHours;
      } else {
        customHoursInputDiv.classList.add('hidden');
        scopeTiers.classList.remove('hidden');
      }

      calculateCost();
    };

    // Event Listeners
    serviceOptions.addEventListener('change', (e) => {
      currentTrack = e.target.value;
      updateDescription();
    });

    // Tier selection is only relevant for Tracks I/II
    scopeTiers.addEventListener('change', (e) => {
      // Added check to ensure it's a radio button change within the tiers container
      if (e.target.name === 'scope') {
        currentScope = e.target.value.toLowerCase();
        calculateCost();
      }
    });

    // Custom Hours input (Track III)
    customHoursInput.addEventListener('input', calculateCost);

    ecoRecyclingToggle.addEventListener('change', (e) => {
      isEcoRecycling = e.target.checked;
      calculateCost();
    });

    complexitySlider.addEventListener('input', (e) => {
      currentComplexity = parseInt(e.target.value, 10);
      calculateCost();
    });

    // Initial setup
    // Find the initially checked radio button to set initial state
    const initialTrackEl = document.querySelector('input[name="service"]:checked');
    if (initialTrackEl) {
      currentTrack = initialTrackEl.value;
    }
    
    updateDescription(); // Set initial Track I description and logic visibility
    calculateCost(); // Calculate initial cost
  });
</script>
